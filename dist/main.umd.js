(function(e,u){typeof exports=="object"&&typeof module!="undefined"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(e=typeof globalThis!="undefined"?globalThis:e||self,u(e.__LAKE__={}))})(this,function(e){"use strict";var L=Object.defineProperty;var U=(e,u,c)=>u in e?L(e,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[u]=c;var a=(e,u,c)=>(U(e,typeof u!="symbol"?u+"":u,c),c);function u(n,t){if(!n)throw new Error(t||"unexpected condition")}const c=(n,t)=>Array.from((t!=null?t:document).querySelectorAll(n)),l=n=>typeof n=="function";function w(){}class C{constructor(t){a(this,"onUnmount",[]);a(this,"unmount",()=>{this.onUnmount.forEach(t=>t())});a(this,"addChild",t=>{this.onUnmount.push(t.unmount)});const o=t||w;this.onUnmount.push(o)}}function m({setup:n,components:t}){return(o,i)=>{const d=new C(n(o,i));return t&&Object.entries(t).forEach(([r,s])=>{c(r).forEach(N=>{const O=s.props||{},D=m(s)(N,O);d.addChild(D)})}),d}}const f=new Map,h=new WeakMap;function _(n,t){h.set(n,t)}function $(n){return n}function p(n,t){return u(!f.has(n),`${n} was already registered`),f.set(n,m(t)),f}function v(n){return u(f.has(n),`${n} does not registered`),f.delete(n),f}function M(n,t,o){u(f.has(o),`${o} was never registered`);const i=f.get(o);_(n,i(n,t))}function R(n,t=document.body){c(n,t).filter(o=>h.has(o)).forEach(o=>h.get(o).unmount())}let j;function E(){throw new Error("Function called outside component initialization")}function g(n){E().$$.on_destroy.push(n)}function y(n){return E().$$.context.get(n)}Promise.resolve();function S(n,t){const o=r=>{const s=c(`[data-ref="${r}"]`,t);return i(s,r)},i=(r,s)=>{switch(r.length){case 0:throw new Error(`data-ref="${s}" does not exist`);case 1:return r[0];default:return r}};return[...n].reduce((r,s)=>(r[s]=o(s),r),{})}function b(n){return{setup(t,o){const i=new Map;i.set("$",{rootRef:t,useDOMRef:(...r)=>({refs:S(new Set(r),t)})});const d=new n({target:t,props:o,context:i});return()=>{d.$destroy(),i.clear()}}}}function A(){return y("$")}function P(n,t,o,i){const d=Array.isArray(n);d?n.forEach(r=>r.addEventListener(t,o,i)):n.addEventListener(t,o,i),g(()=>{d?n.forEach(r=>r.removeEventListener(t,o,i)):n.removeEventListener(t,o,i)})}e.assert=u,e.defineComponent=$,e.getContext$=A,e.isFunc=l,e.mount=M,e.q=c,e.register=p,e.unmount=R,e.unregister=v,e.useEvent=P,e.withSvelte=b,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
