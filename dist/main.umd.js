var J=Object.defineProperty;var $=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var R=(t,o,s)=>o in t?J(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,w=(t,o)=>{for(var s in o||(o={}))Q.call(o,s)&&R(t,s,o[s]);if($)for(var s of $(o))X.call(o,s)&&R(t,s,o[s]);return t};var d=(t,o,s)=>(R(t,typeof o!="symbol"?o+"":o,s),s),y=(t,o,s)=>{if(!o.has(t))throw TypeError("Cannot "+s)};var U=(t,o,s)=>(y(t,o,"read from private field"),s?s.call(t):o.get(t)),D=(t,o,s)=>{if(o.has(t))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(t):o.set(t,s)},O=(t,o,s,M)=>(y(t,o,"write to private field"),M?M.call(t,s):o.set(t,s),s);(function(t,o){typeof exports=="object"&&typeof module!="undefined"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(t=typeof globalThis!="undefined"?globalThis:t||self,o(t.__LAKE__={}))})(this,function(t){var l,f,F,H;"use strict";const o=(e,n)=>Array.from((n!=null?n:document).querySelectorAll(e));class s{constructor(n){D(this,l,void 0);O(this,l,n)}get value(){return U(this,l)}set value(n){O(this,l,n)}}l=new WeakMap;const M=e=>new s(e);class S{constructor(n){D(this,f,void 0);O(this,f,n)}get value(){return U(this,f).value}}f=new WeakMap;const I=e=>new S(e);function p(e,n){if(!e)throw new Error(n||"unexpected condition")}const T=e=>console.warn(e),b=e=>e.forEach(n=>n());var h=(e=>(e.MOUNTED="onMounted",e.UNMOUNTED="onUnmounted",e))(h||{});const g=e=>n=>{N(e)[e].push(n)},P=g("onMounted"),v=g("onUnmounted");let C=null;const x=e=>C=e,W=()=>C=null,N=e=>(p(C,`"${e}" called outside setup() will never be run.`),C);let j=0;class q{constructor(n){d(this,F,[]);d(this,H,[]);d(this,"uid");d(this,"parent",null);d(this,"children",[]);d(this,"mount",()=>{b([...this[h.MOUNTED],...this.children.flatMap(n=>n.mount)])});d(this,"unmount",()=>{b([...this[h.UNMOUNTED],...this.children.flatMap(n=>n.unmount)])});this.element=n,this.uid=n.id||j++}addChild(n){this.children.push(n),n.parent=this}removeChild(n){const r=this.children.findIndex(u=>u===n);r!==-1&&(this.children.splice(r,1),n.parent=null)}}F=h.MOUNTED,H=h.UNMOUNTED;function _(e){return(n,r)=>{const u=new q(n);return x(u),e.setup(n,w(w({},e.props),r)),W(),u}}const c=new Map,E=new WeakMap,L=(e,n,r)=>{E.has(e)&&T(`The DOM of ${r} was already bind.`),E.set(e,n)},A=e=>e;function k(){return{register(e,n){return p(!c.has(e),`${e} was already registered.`),c.set(e,_(n)),c},unregister(e){return p(c.has(e),`${e} does not registered.`),c.delete(e),c},mount(e,n,r){p(c.has(r),`${r} was never registered.`);const u=c.get(r)(e,n);L(e,u,r),u.mount()},unmount(e,n){o(e,n).filter(r=>E.has(r)).forEach(r=>E.get(r).unmount())}}}function G(){const e=N("createChildComponent");return{addChild(n,r,u){return o(n,e.element).map(m=>{const i=_(r)(m,w(w({},r.props),u));return e.addChild(i),i})},removeChild(n){e.removeChild(n)}}}const K=(e,n,r,u)=>{e.addEventListener(n,r,u),v(()=>{e.removeEventListener(n,r,u)})};function V(e,n){const r=i=>{const a=o(`[data-ref="${i}"]`,n);return u(a,i)},u=(i,a)=>{switch(i.length){case 0:return T(`[data-ref="${a}"] does not exist.`),null;case 1:return i[0];default:return i}};return[...e].reduce((i,a)=>(i[a]=r(a),i),{})}function Y(...e){const n=N("domRef");return{refs:V(new Set(e),n.element)}}const z=(e,n,r={rootMargin:"0px",threshold:.1})=>{const u=new IntersectionObserver(n,r);return Array.isArray(e)?e.forEach(i=>u.observe(i)):u.observe(e),v(()=>{u.disconnect()}),{unwatch:i=>{u.unobserve(i)}}};function B(e){return A({setup(n,r){const u=new Map([["$",{rootRef:n}]]),m=new e({target:n,props:r,context:u});v(()=>{m.$destroy()})}})}t.createApp=k,t.createChildComponent=G,t.defineComponent=A,t.onMounted=P,t.onUnmounted=v,t.q=o,t.readonly=I,t.ref=M,t.useDOMRef=Y,t.useEvent=K,t.useIntersectionWatch=z,t.withSvelte=B,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
