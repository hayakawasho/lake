var B=Object.defineProperty;var F=(t,s,r)=>s in t?B(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var a=(t,s,r)=>(F(t,typeof s!="symbol"?s+"":s,r),r),O=(t,s,r)=>{if(!s.has(t))throw TypeError("Cannot "+r)};var l=(t,s,r)=>(O(t,s,"read from private field"),r?r.call(t):s.get(t)),U=(t,s,r)=>{if(s.has(t))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(t):s.set(t,r)},C=(t,s,r,v)=>(O(t,s,"write to private field"),v?v.call(t,r):s.set(t,r),r);(function(t,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(t=typeof globalThis<"u"?globalThis:t||self,s(t.__LAKE__={}))})(this,function(t){var m,p,V,g,f;"use strict";class s{constructor(n){U(this,m,void 0);C(this,m,n)}get value(){return l(this,m)}set value(n){C(this,m,n)}}m=new WeakMap;const r=e=>new s(e);class v{constructor(n){U(this,p,void 0);C(this,p,n)}get value(){return l(this,p).value}}p=new WeakMap;const A=e=>new v(e);function T(e,n){if(!e)throw new Error(n||"unexpected condition")}var h=(e=>(e.MOUNTED="Mounted",e.UNMOUNTED="Unmounted",e))(h||{});const y=e=>n=>{N(e)[e].push(n)},D=y("Mounted"),M=y("Unmounted");let E;const R=e=>E=e,N=e=>(T(E,`"${e}" called outside setup() will never be run.`),E);let $=0;class _{constructor(n,o){a(this,V,[]);a(this,g,[]);a(this,"parent",null);U(this,f,[]);a(this,"uid");a(this,"current",{});a(this,"onMount",()=>{const n=this[h.MOUNTED].map(o=>o()).filter(o=>typeof o=="function");this[h.UNMOUNTED].push(...n)});a(this,"onUnmount",()=>{[...this[h.UNMOUNTED],...l(this,f).flatMap(o=>o.onUnmount)].forEach(o=>o())});a(this,"addChild",n=>{l(this,f).push(n),n.parent=this,n.onMount()});a(this,"removeChild",n=>{const o=l(this,f).indexOf(n);o!==-1&&(l(this,f).splice(o,1),n.parent=null,n.onUnmount())});this.element=n,this.uid=`${o}.${$++}`}}V=h.MOUNTED,g=h.UNMOUNTED,f=new WeakMap;const S=e=>{const n=E;return(o,u)=>{const i=new _(o,e.name),c=R(i),d=e.setup(o,u);return c.current=d||{},R(n),c}},w=new WeakMap,I=(e,n,o)=>{if(w.has(e)){console.error(`${o} was already bind.`);return}w.set(e,n)},x=()=>({component(e){return(n,o={})=>{const u=S(e)(n,o);return I(n,u,e.name),u.onMount(),u}},unmount(e){e.filter(n=>w.has(n)).forEach(n=>w.get(n).onUnmount())}}),b=e=>e,W=(e,n,o,u)=>{e.addEventListener(n,o,u),M(()=>{e.removeEventListener(n,o,u)})},j=(e,n)=>Array.from((n??document).querySelectorAll(e));function q(e,n){const o=i=>{const c=j(`[data-ref="${i}"]`,n),{length:d}=c;return d===0?null:{1:c[0]}[d]??c};return[...e].reduce((i,c)=>(i[c]=o(c),i),{})}function L(...e){const n=N("DomRef");return{refs:q(new Set(e),n.element)}}const P=(e,n,o={rootMargin:"0px",threshold:.1})=>{const u=new IntersectionObserver(n,o),i=d=>{Array.isArray(d)?d.forEach(z=>u.observe(z)):u.observe(d)};return D(()=>{i(e)}),M(()=>{u.disconnect()}),{unwatch:d=>{u.unobserve(d)}}},k=()=>{const e=N("Slot");return{addChild(n,o,u={}){const i=c=>{const d=S(o)(c,u);return e.addChild(d),d};return Array.isArray(n)?n.map(c=>i(c)):[i(n)]},removeChild(n){n.forEach(o=>e.removeChild(o))}}};function K(e,n="withSvelte"){return b({name:n,setup(o,u){const i=new Map([["$",{rootRef:o,...u}]]),c=new e({target:o,context:i});M(()=>{c.$destroy()})}})}t.create=x,t.defineComponent=b,t.readonly=A,t.ref=r,t.useDomRef=L,t.useEvent=W,t.useIntersectionWatch=P,t.useMount=D,t.useSlot=k,t.useUnmount=M,t.withSvelte=K,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});
