(function(o,s){typeof exports=="object"&&typeof module!="undefined"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(o=typeof globalThis!="undefined"?globalThis:o||self,s(o.__LAKE__={}))})(this,function(o){"use strict";var L=Object.defineProperty;var j=(o,s,i)=>s in o?L(o,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[s]=i;var a=(o,s,i)=>(j(o,typeof s!="symbol"?s+"":s,i),i);function s(n,e){if(!n)throw new Error(e||"unexpected condition")}const i=(n,e)=>Array.from((e!=null?e:document).querySelectorAll(n)),w=()=>{};class C{constructor(e){a(this,"onUnmount",[]);a(this,"unmount",()=>{this.onUnmount.forEach(e=>e())});const t=e||w;this.onUnmount.push(t)}addChild(e){this.onUnmount.push(e.unmount)}}function m(n){return(e,t)=>{const u=Object.assign(n.props,t),d=n.setup(e,u),r=new C(d);return n.components&&Object.entries(n.components).forEach(([f,p])=>{i(f).forEach(N=>{const P=p.props||{},D=m(p)(N,P);r.addChild(D)})}),r}}const c=new Map,h=new WeakMap,$=(n,e,t)=>{s(!h.has(n),`The DOM of ${t} was already bind`),h.set(n,e)},l=n=>n;function _(n,e){return s(!c.has(n),`${n} was already registered`),c.set(n,m(e)),c}function g(n){return s(c.has(n),`${n} does not registered`),c.delete(n),c}function M(n,e,t){s(c.has(t),`${t} was never registered`);const u=c.get(t);$(n,u(n,e),t)}function v(n,e){i(n,e).filter(t=>h.has(t)).forEach(t=>h.get(t).unmount())}let U;function E(){throw new Error("Function called outside component initialization")}function y(n){E().$$.on_destroy.push(n)}function R(n){return E().$$.context.get(n)}Promise.resolve();function S(n,e){const t=r=>{const f=i(`[data-ref="${r}"]`,e);return u(f,r)},u=(r,f)=>{switch(r.length){case 0:throw new Error(`[data-ref="${f}"] does not exist`);case 1:return r[0];default:return r}};return[...n].reduce((r,f)=>(r[f]=t(f),r),{})}function A(n){return l({setup(e,t){const u=new Map;u.set("$",{rootRef:e,useDOMRef:(...r)=>({refs:S(new Set(r),e)})});const d=new n({target:e,props:t,context:u});return()=>{d.$destroy()}}})}function O(){return R("$")}function b(n,e,t,u){const d=Array.isArray(n);d?n.forEach(r=>r.addEventListener(e,t,u)):n.addEventListener(e,t,u),y(()=>{d?n.forEach(r=>r.removeEventListener(e,t,u)):n.removeEventListener(e,t,u)})}o.assert=s,o.defineComponent=l,o.getContext$=O,o.mount=M,o.q=i,o.register=_,o.unmount=v,o.unregister=g,o.useEvent=b,o.withSvelte=A,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
