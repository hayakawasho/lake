(function(e,o){typeof exports=="object"&&typeof module!="undefined"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(e=typeof globalThis!="undefined"?globalThis:e||self,o(e.__LAKE__={}))})(this,function(e){"use strict";var L=Object.defineProperty;var $=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var h=(e,o,s)=>o in e?L(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,l=(e,o)=>{for(var s in o||(o={}))q.call(o,s)&&h(e,s,o[s]);if($)for(var s of $(o))x.call(o,s)&&h(e,s,o[s]);return e};var m=(e,o,s)=>(h(e,typeof o!="symbol"?o+"":o,s),s);function o(n,t){if(!n)throw new Error(t||"unexpected condition")}const s=(n,t)=>Array.from((t!=null?t:document).querySelectorAll(n)),C=()=>{};class _{constructor(t){m(this,"onUnmount",[]);m(this,"unmount",()=>{this.onUnmount.forEach(t=>t())});const r=t||C;this.onUnmount.push(r)}addChild(t){this.onUnmount.push(t.unmount)}}function p(n){return(t,r)=>{const i=l(l({},n.props),r),a=n.setup(t,i),u=new _(a);return n.components&&Object.entries(n.components).forEach(([d,w])=>{s(d).forEach(A=>{const U=w.props||{},j=p(w)(A,U);u.addChild(j)})}),u}}const c=new Map,f=new WeakMap,M=(n,t,r)=>{o(!f.has(n),`The DOM of ${r} was already bind`),f.set(n,t)},g=n=>n;function v(n,t){return o(!c.has(n),`${n} was already registered`),c.set(n,p(t)),c}function O(n){return o(c.has(n),`${n} does not registered`),c.delete(n),c}function S(n,t,r){o(c.has(r),`${r} was never registered`);const i=c.get(r);M(n,i(n,t),r)}function y(n,t){s(n,t).filter(r=>f.has(r)).forEach(r=>f.get(r).unmount())}let I;function E(){throw new Error("Function called outside component initialization")}function R(n){E().$$.on_destroy.push(n)}function T(n){return E().$$.context.get(n)}Promise.resolve();function N(n,t){const r=u=>{const d=s(`[data-ref="${u}"]`,t);return i(d,u)},i=(u,d)=>{switch(u.length){case 0:throw new Error(`[data-ref="${d}"] does not exist`);case 1:return u[0];default:return u}};return[...n].reduce((u,d)=>(u[d]=r(d),u),{})}const P=n=>g({setup(t,r){const i=new Map;i.set("$",{rootRef:t,useDOMRef:(...u)=>({refs:N(new Set(u),t)})});const a=new n({target:t,props:r,context:i});return()=>{a.$destroy()}}}),b=()=>T("$"),D=(n,t,r)=>{n.addEventListener(t,r),R(()=>{n.removeEventListener(t,r)})};e.assert=o,e.defineComponent=g,e.getContext$=b,e.mount=S,e.q=s,e.register=v,e.unmount=y,e.unregister=O,e.useEvent=D,e.withSvelte=P,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
