(function(t,u){typeof exports=="object"&&typeof module!="undefined"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(t=typeof globalThis!="undefined"?globalThis:t||self,u(t.__LAKE__={}))})(this,function(t){"use strict";var D=Object.defineProperty;var L=(t,u,i)=>u in t?D(t,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[u]=i;var h=(t,u,i)=>(L(t,typeof u!="symbol"?u+"":u,i),i);function u(n,e){if(!n)throw new Error(e||"unexpected condition")}const i=(n,e)=>Array.from((e!=null?e:document).querySelectorAll(n)),w=n=>typeof n=="function";function _(){}class ${constructor(e,o){h(this,"parent",null);h(this,"children");this._cleanup=e,this.children=o.children}unmount(){(this._cleanup||_)()}}const l=new WeakMap;function C(n,e){l.set(n,e)}function a(n){const{components:e}=n,o=p(e!=null?e:{});return(c,f)=>{const r=n.setup(c,f);C(c,new $(r,{children:o}))}}function p(n){return Object.entries(n).reduce((e,[o,c])=>(e[o]=a(c),e),{})}const s=new Map;function m({setup:n,components:e}){return{setup:n,components:e}}function v(n,e){return u(!s.has(n),`${n} was already registered`),s.set(n,a(e)),s}function M(n){return u(s.has(n),`${n} does not registered`),s.delete(n),s}function R(n,e,o){return u(s.has(o),`${o} was never registered`),s.get(o)(n,e)}function g(n){return n.filter(e=>l.has(e)).forEach(e=>l.get(e).unmount())}function S(n){return(e,o={})=>a(n)(e,o)}let j;function E(){throw new Error("Function called outside component initialization")}function y(n){E().$$.on_destroy.push(n)}function A(n){return E().$$.context.get(n)}Promise.resolve();function O(n,e){const o=r=>{const d=i(`[data-ref="${r}"]`,e);return c(d,r)},c=(r,d)=>{switch(r.length){case 0:throw new Error(`data-ref="${d}" does not exist`);case 1:return r[0];default:return r}};return[...n].reduce((r,d)=>(r[d]=o(d),r),{})}function P(n){return m({setup(e,o){const c=new Map;c.set("$",{rootRef:e,useDOMRef:(...r)=>({refs:O(new Set(r),e)})});const f=new n({target:e,props:o,context:c});return()=>{f.$destroy(),c.clear()}}})}function N(){return A("$")}function b(n,e,o,c){const f=Array.isArray(n);f?n.forEach(r=>r.addEventListener(e,o,c)):n.addEventListener(e,o,c),y(()=>{f?n.forEach(r=>r.removeEventListener(e,o,c)):n.removeEventListener(e,o,c)})}t.assert=u,t.component=S,t.defineComponent=m,t.getContext$=N,t.isFunc=w,t.mount=R,t.q=i,t.register=v,t.unmount=g,t.unregister=M,t.useEvent=b,t.withSvelte=P,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
