(function(t,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(t=typeof globalThis<"u"?globalThis:t||self,o(t.__LAKE__={}))})(this,function(t){var h,p,z,B,l;"use strict";var F=Object.defineProperty;var G=(t,o,u)=>o in t?F(t,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[o]=u;var d=(t,o,u)=>(G(t,typeof o!="symbol"?o+"":o,u),u),_=(t,o,u)=>{if(!o.has(t))throw TypeError("Cannot "+u)};var f=(t,o,u)=>(_(t,o,"read from private field"),u?u.call(t):o.get(t)),C=(t,o,u)=>{if(o.has(t))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(t):o.set(t,u)},N=(t,o,u,v)=>(_(t,o,"write to private field"),v?v.call(t,u):o.set(t,u),u);class o{constructor(e){C(this,h,void 0);N(this,h,e)}get value(){return f(this,h)}set value(e){N(this,h,e)}}h=new WeakMap;const u=n=>new o(n);class v{constructor(e){C(this,p,void 0);N(this,p,e)}get value(){return f(this,p).value}}p=new WeakMap;const $=n=>new v(n);function O(n,e){if(!n)throw new Error(e||"unexpected condition")}const U=n=>n.forEach(e=>e());var m=(n=>(n.MOUNTED="Mounted",n.UNMOUNTED="Unmounted",n))(m||{});const D=n=>e=>{R(n)[n].push(e)},T=D("Mounted"),M=D("Unmounted");let E;const b=n=>E=n,R=n=>(O(E,`"${n}" called outside setup() will never be run.`),E);let I=0;class x{constructor(e){d(this,z,[]);d(this,B,[]);d(this,"parent",null);C(this,l,[]);d(this,"uid");d(this,"current",{});d(this,"mount",()=>{U([...this[m.MOUNTED],...f(this,l).flatMap(e=>e.mount)])});d(this,"unmount",()=>{U([...this[m.UNMOUNTED],...f(this,l).flatMap(e=>e.unmount)])});d(this,"addChild",e=>{f(this,l).push(e),e.parent=this});d(this,"removeChild",e=>{const r=f(this,l).findIndex(s=>s===e);r!==-1&&(f(this,l).splice(r,1),e.parent=null)});this.element=e,this.uid=I++}}z=m.MOUNTED,B=m.UNMOUNTED,l=new WeakMap;const y=n=>{const e=E;return(r,s)=>{const a=b(new x(r)),c=n.setup(r,{...n.props,...s});return a.current=c||{},b(e),a}},w=new WeakMap,W=(n,e,r)=>{if(w.has(n)){console.error(`${r} was already bind.`);return}w.set(n,e)},j=()=>({component(n){return(e,r={})=>{const s=y(n)(e,r);return W(e,s,n.tag||""),s.mount(),s}},unmount(n){n.filter(e=>w.has(e)).forEach(e=>w.get(e).unmount())}}),S=n=>n,L=(n,e,r,s)=>{n.addEventListener(e,r,s),M(()=>{n.removeEventListener(e,r,s)})},P=(n,e)=>Array.from((e??document).querySelectorAll(n));function g(n,e){const r=c=>{const i=P(`[data-ref="${c}"]`,e);return s(i,c)},s=(c,i)=>{switch(c.length){case 0:return console.error(`[data-ref="${i}"] does not exist.`),null;case 1:return c[0];default:return c}};return[...n].reduce((c,i)=>(c[i]=r(i),c),{})}function k(...n){const e=R("DomRef");return{refs:g(new Set(n),e.element)}}const K=(n,e,r={rootMargin:"0px",threshold:.1})=>{const s=new IntersectionObserver(e,r);return Array.isArray(n)?n.forEach(c=>s.observe(c)):s.observe(n),M(()=>{s.disconnect()}),{unwatch:c=>{s.unobserve(c)}}},V=()=>{const n=R("Slot");return{addChild(e,r,s={}){const a=[],c=i=>{const A=y(r)(i,{...r.props,...s});n.addChild(A),a.push(A)};return Array.isArray(e)?e.forEach(i=>c(i)):c(e),a},removeChild(e){e.forEach(r=>n.removeChild(r))}}};function q(n){return S({setup(e,r){const s=new Map([["$",{rootRef:e,...r}]]),a=new n({target:e,context:s});M(()=>{a.$destroy()})}})}t.default=j,t.defineComponent=S,t.readonly=$,t.ref=u,t.useDomRef=k,t.useEvent=L,t.useIntersectionWatch=K,t.useMount=T,t.useSlot=V,t.useUnmount=M,t.withSvelte=q,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
