(function(e,r){typeof exports=="object"&&typeof module!="undefined"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(e=typeof globalThis!="undefined"?globalThis:e||self,r(e.__LAKE__={}))})(this,function(e){"use strict";var F=Object.defineProperty;var _=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var T=(e,r,i)=>r in e?F(e,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[r]=i;var $=(e,r)=>{var i={};for(var s in e)q.call(e,s)&&r.indexOf(s)<0&&(i[s]=e[s]);if(e!=null&&_)for(var s of _(e))r.indexOf(s)<0&&I.call(e,s)&&(i[s]=e[s]);return i};var l=(e,r,i)=>(T(e,typeof r!="symbol"?r+"":r,i),i);function r(n,t){if(!n)throw new Error(t||"unexpected condition")}const i=(n,t)=>Array.from((t!=null?t:document).querySelectorAll(n)),s=n=>typeof n=="function";function g(){}class M{constructor(t){l(this,"onUnmount",[]);l(this,"unmount",()=>{this.onUnmount.forEach(t=>t())});const o=t||g;this.onUnmount.push(o)}addChild(t){this.onUnmount.push(t.unmount)}}function E(n){return(t,o)=>{const c=Object.assign({el:t},n.props,o),a=n.setup(c),u=new M(a);return n.components&&Object.entries(n.components).forEach(([f,m])=>{i(f).forEach(L=>{const j=m.props||{},U=E(m)(L,j);u.addChild(U)})}),u}}const d=new Map,h=new WeakMap;function v(n,t,o){r(!h.has(n),`the DOM of ${o} was already binding`),h.set(n,t)}const w=n=>n;function y(n,t){return r(!d.has(n),`${n} was already registered`),d.set(n,E(t)),d}function R(n){return r(d.has(n),`${n} does not registered`),d.delete(n),d}function p(n,t,o){r(d.has(o),`${o} was never registered`);const c=d.get(o);v(n,c(n,t),o)}function O(n,t=document.body){i(n,t).filter(o=>h.has(o)).forEach(o=>h.get(o).unmount())}let k;function C(){throw new Error("Function called outside component initialization")}function P(n){C().$$.on_destroy.push(n)}function S(n){return C().$$.context.get(n)}Promise.resolve();function b(n,t){const o=u=>{const f=i(`[data-ref="${u}"]`,t);return c(f,u)},c=(u,f)=>{switch(u.length){case 0:throw new Error(`data-ref="${f}" does not exist`);case 1:return u[0];default:return u}};return[...n].reduce((u,f)=>(u[f]=o(f),u),{})}function A(n){return w({setup(c){var a=c,{el:t}=a,o=$(a,["el"]);const u=new Map;u.set("$",{rootRef:t,useDOMRef:(...m)=>({refs:b(new Set(m),t)})});const f=new n({target:t,props:o,context:u});return()=>{f.$destroy(),u.clear()}}})}function N(){return S("$")}function D(n,t,o,c){const a=Array.isArray(n);a?n.forEach(u=>u.addEventListener(t,o,c)):n.addEventListener(t,o,c),P(()=>{a?n.forEach(u=>u.removeEventListener(t,o,c)):n.removeEventListener(t,o,c)})}e.assert=r,e.defineComponent=w,e.getContext$=N,e.isFunc=s,e.mount=p,e.q=i,e.register=y,e.unmount=O,e.unregister=R,e.useEvent=D,e.withSvelte=A,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
