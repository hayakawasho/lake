(function(e,o){typeof exports=="object"&&typeof module!="undefined"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(e=typeof globalThis!="undefined"?globalThis:e||self,o(e.__LAKE__={}))})(this,function(e){"use strict";var L=Object.defineProperty;var $=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var h=(e,o,u)=>o in e?L(e,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[o]=u,l=(e,o)=>{for(var u in o||(o={}))q.call(o,u)&&h(e,u,o[u]);if($)for(var u of $(o))x.call(o,u)&&h(e,u,o[u]);return e};var m=(e,o,u)=>(h(e,typeof o!="symbol"?o+"":o,u),u);function o(n,t){if(!n)throw new Error(t||"unexpected condition")}function u(n,t){return Array.from((t!=null?t:document).querySelectorAll(n))}function C(){}class _{constructor(t){m(this,"onUnmount",[]);m(this,"unmount",()=>{this.onUnmount.forEach(t=>t())});const r=t||C;this.onUnmount.push(r)}addChild(t){this.onUnmount.push(t.unmount)}}function p(n){return(t,r)=>{const c=l(l({},n.props),r),a=n.setup(t,c),s=new _(a);return n.components&&Object.entries(n.components).forEach(([d,w])=>{u(d).forEach(A=>{const U=w.props||{},j=p(w)(A,U);s.addChild(j)})}),s}}const i=new Map,f=new WeakMap,M=(n,t,r)=>{o(!f.has(n),`The DOM of ${r} was already bind`),f.set(n,t)},g=n=>n;function v(n,t){return o(!i.has(n),`${n} was already registered`),i.set(n,p(t)),i}function O(n){return o(i.has(n),`${n} does not registered`),i.delete(n),i}function S(n,t,r){o(i.has(r),`${r} was never registered`);const c=i.get(r);M(n,c(n,t),r)}function y(n,t){u(n,t).filter(r=>f.has(r)).forEach(r=>f.get(r).unmount())}let I;function E(){throw new Error("Function called outside component initialization")}function R(n){E().$$.on_destroy.push(n)}function T(n){return E().$$.context.get(n)}Promise.resolve();function N(n,t){const r=s=>{const d=u(`[data-ref="${s}"]`,t);return c(d,s)},c=(s,d)=>{switch(s.length){case 0:throw new Error(`[data-ref="${d}"] does not exist`);case 1:return s[0];default:return s}};return[...n].reduce((s,d)=>(s[d]=r(d),s),{})}function P(n){return g({setup(t,r){const c=new Map;c.set("$",{rootRef:t,useDOMRef:(...s)=>({refs:N(new Set(s),t)})});const a=new n({target:t,props:r,context:c});return()=>{a.$destroy()}}})}const b=()=>T("$"),D=(n,t,r)=>{n.addEventListener(t,r),R(()=>{n.removeEventListener(t,r)})};e.assert=o,e.defineComponent=g,e.getContext$=b,e.mount=S,e.q=u,e.register=v,e.unmount=y,e.unregister=O,e.useEvent=D,e.withSvelte=P,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
